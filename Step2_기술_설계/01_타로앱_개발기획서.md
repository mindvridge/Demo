# ğŸ”§ TarotMind ê°œë°œ ê¸°íšì„œ
## Technical Specification Document v1.0

---

## ğŸ“‹ ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
4. [API ì„¤ê³„](#api-ì„¤ê³„)
5. [AI/ML ì‹œìŠ¤í…œ](#aiml-ì‹œìŠ¤í…œ)
6. [UI/UX ìƒì„¸ ì„¤ê³„](#uiux-ìƒì„¸-ì„¤ê³„)
7. [ë³´ì•ˆ ë° ì¸í”„ë¼](#ë³´ì•ˆ-ë°-ì¸í”„ë¼)
8. [ê°œë°œ í”„ë¡œì„¸ìŠ¤](#ê°œë°œ-í”„ë¡œì„¸ìŠ¤)
9. [í…ŒìŠ¤íŠ¸ ì „ëµ](#í…ŒìŠ¤íŠ¸-ì „ëµ)
10. [ë°°í¬ ë° ìš´ì˜](#ë°°í¬-ë°-ìš´ì˜)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 í”„ë¡œì íŠ¸ ì •ë³´
- **í”„ë¡œì íŠ¸ëª…**: TarotMind
- **ë²„ì „**: MVP v1.0
- **ê°œë°œ ê¸°ê°„**: 12ì£¼ (3ê°œì›”)
- **í”Œë«í¼**: iOS, Android, Web
- **ëŒ€ìƒ**: 18-35ì„¸ í•œêµ­ MZì„¸ëŒ€

### 1.2 ê¸°ìˆ  ìŠ¤íƒ ê²°ì •

#### Frontend
```yaml
Mobile:
  Framework: React Native 0.72+
  State Management: Redux Toolkit + RTK Query
  Navigation: React Navigation 6
  UI Library: React Native Elements + Custom Components
  Animation: Lottie, Reanimated 3
  
Web:
  Framework: Next.js 14
  Language: TypeScript 5.0+
  Styling: Tailwind CSS + Emotion
  State: Zustand
```

#### Backend
```yaml
Server:
  Runtime: Node.js 20 LTS
  Framework: NestJS
  Language: TypeScript
  API: GraphQL (Apollo Server) + REST
  
Database:
  Primary: PostgreSQL 15
  Cache: Redis 7
  Search: Elasticsearch
  File Storage: AWS S3
```

#### Infrastructure
```yaml
Cloud: AWS
Container: Docker + Kubernetes (EKS)
CI/CD: GitHub Actions
Monitoring: DataDog + Sentry
CDN: CloudFront
```

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 2.1 ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```mermaid
graph TB
    subgraph "Client Layer"
        iOS[iOS App]
        Android[Android App]
        Web[Web App]
    end
    
    subgraph "API Gateway"
        Gateway[Kong API Gateway]
        Auth[Auth Service]
    end
    
    subgraph "Application Layer"
        GraphQL[GraphQL Server]
        REST[REST API]
        WebSocket[WebSocket Server]
    end
    
    subgraph "Business Logic"
        UserService[User Service]
        TarotService[Tarot Engine]
        PaymentService[Payment Service]
        NotificationService[Notification Service]
        AIService[AI Service]
    end
    
    subgraph "Data Layer"
        PostgreSQL[(PostgreSQL)]
        Redis[(Redis)]
        S3[AWS S3]
        ElasticSearch[(ElasticSearch)]
    end
    
    subgraph "AI/ML Layer"
        GPT[OpenAI GPT-4]
        CustomML[Custom ML Models]
        Analytics[Analytics Engine]
    end
    
    iOS --> Gateway
    Android --> Gateway
    Web --> Gateway
    
    Gateway --> Auth
    Auth --> GraphQL
    Auth --> REST
    
    GraphQL --> UserService
    GraphQL --> TarotService
    REST --> PaymentService
    WebSocket --> NotificationService
    
    TarotService --> AIService
    AIService --> GPT
    AIService --> CustomML
    
    UserService --> PostgreSQL
    TarotService --> Redis
    PaymentService --> PostgreSQL
    NotificationService --> Redis
    
    TarotService --> S3
    Analytics --> ElasticSearch
```

### 2.2 ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ êµ¬ì¡°

| ì„œë¹„ìŠ¤ | ì±…ì„ | ê¸°ìˆ  ìŠ¤íƒ | í¬íŠ¸ |
|--------|------|----------|------|
| API Gateway | ë¼ìš°íŒ…, ì¸ì¦, ì œí•œ | Kong | 8000 |
| Auth Service | ì¸ì¦/ì¸ê°€ | Node.js + JWT | 3001 |
| User Service | ì‚¬ìš©ì ê´€ë¦¬ | NestJS | 3002 |
| Tarot Service | íƒ€ë¡œ ë¦¬ë”© ì—”ì§„ | NestJS + Python | 3003 |
| Payment Service | ê²°ì œ ì²˜ë¦¬ | NestJS | 3004 |
| Notification Service | í‘¸ì‹œ/ì´ë©”ì¼ | Node.js | 3005 |
| AI Service | AI ì²˜ë¦¬ | Python FastAPI | 3006 |
| Analytics Service | ë¶„ì„/ì¶”ì  | Node.js | 3007 |

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 3.1 ì£¼ìš” í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ

#### Users í…Œì´ë¸”
```sql
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    username VARCHAR(50) UNIQUE,
    password_hash VARCHAR(255),
    phone VARCHAR(20),
    birth_date DATE,
    gender VARCHAR(10),
    zodiac_sign VARCHAR(20),
    subscription_tier VARCHAR(20) DEFAULT 'free',
    subscription_expires_at TIMESTAMP,
    coins INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP,
    
    INDEX idx_email (email),
    INDEX idx_subscription (subscription_tier, subscription_expires_at)
);
```

#### Tarot_Cards í…Œì´ë¸”
```sql
CREATE TABLE tarot_cards (
    id INTEGER PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    arcana VARCHAR(20) NOT NULL, -- 'major' or 'minor'
    suit VARCHAR(20), -- cups, wands, swords, pentacles
    number INTEGER,
    keywords JSONB,
    upright_meaning TEXT,
    reversed_meaning TEXT,
    description TEXT,
    image_url VARCHAR(500),
    symbolism JSONB,
    numerology INTEGER,
    element VARCHAR(20),
    astrological_sign VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_arcana (arcana),
    INDEX idx_suit (suit)
);
```

#### Readings í…Œì´ë¸”
```sql
CREATE TABLE readings (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    spread_type VARCHAR(50) NOT NULL,
    question TEXT,
    cards JSONB NOT NULL, -- Array of card positions and orientations
    interpretation TEXT,
    ai_analysis JSONB,
    sentiment_score FLOAT,
    category VARCHAR(50), -- love, career, general, etc
    is_public BOOLEAN DEFAULT false,
    likes_count INTEGER DEFAULT 0,
    views_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_user_readings (user_id, created_at DESC),
    INDEX idx_public_readings (is_public, created_at DESC),
    INDEX idx_category (category)
);
```

#### Spreads í…Œì´ë¸”
```sql
CREATE TABLE spreads (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    card_count INTEGER NOT NULL,
    positions JSONB NOT NULL, -- Array of position definitions
    description TEXT,
    difficulty_level VARCHAR(20),
    category VARCHAR(50),
    is_premium BOOLEAN DEFAULT false,
    usage_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_premium (is_premium),
    INDEX idx_popular (usage_count DESC)
);
```

#### User_Analytics í…Œì´ë¸”
```sql
CREATE TABLE user_analytics (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    event_type VARCHAR(50) NOT NULL,
    event_data JSONB,
    session_id VARCHAR(100),
    device_info JSONB,
    ip_address INET,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_user_events (user_id, created_at DESC),
    INDEX idx_event_type (event_type, created_at DESC)
);
```

### 3.2 Redis ë°ì´í„° êµ¬ì¡°

```yaml
# ì„¸ì…˜ ê´€ë¦¬
session:{user_id}: 
  - token
  - device_info
  - expires_at

# ì¼ì¼ ë¦¬ë”© ì œí•œ
daily_reading:{user_id}:{date}:
  - count
  - TTL: 24 hours

# ìºì‹±
cache:reading:{reading_id}:
  - reading_data
  - TTL: 1 hour

cache:user:{user_id}:
  - user_profile
  - TTL: 30 minutes

# ì‹¤ì‹œê°„ í†µê³„
stats:daily:{date}:
  - total_readings
  - active_users
  - new_users
  
# ë¦¬ë”ë³´ë“œ
leaderboard:readers:weekly:
  - sorted set of user_ids by reading_count
```

---

## 4. API ì„¤ê³„

### 4.1 GraphQL Schema

```graphql
# User Types
type User {
  id: ID!
  email: String!
  username: String
  profile: UserProfile!
  subscription: Subscription!
  stats: UserStats!
  readings: [Reading!]!
  createdAt: DateTime!
}

type UserProfile {
  birthDate: Date
  gender: Gender
  zodiacSign: ZodiacSign
  interests: [String!]
  avatar: String
}

type Subscription {
  tier: SubscriptionTier!
  expiresAt: DateTime
  coins: Int!
  features: [String!]!
}

# Tarot Types
type TarotCard {
  id: Int!
  name: String!
  arcana: Arcana!
  suit: Suit
  number: Int
  keywords: [String!]!
  meaning: CardMeaning!
  imageUrl: String!
  symbolism: Symbolism!
}

type Reading {
  id: ID!
  user: User!
  spread: Spread!
  question: String
  cards: [DrawnCard!]!
  interpretation: String!
  aiAnalysis: AIAnalysis
  category: ReadingCategory!
  sentiment: Float
  createdAt: DateTime!
}

type DrawnCard {
  position: Int!
  card: TarotCard!
  reversed: Boolean!
  positionMeaning: String!
}

# Queries
type Query {
  # User queries
  me: User!
  user(id: ID!): User
  
  # Tarot queries
  dailyCard: DrawnCard!
  reading(id: ID!): Reading
  myReadings(limit: Int, offset: Int): [Reading!]!
  
  # Card database
  cards(arcana: Arcana, suit: Suit): [TarotCard!]!
  card(id: Int!): TarotCard
  
  # Spreads
  spreads(category: String): [Spread!]!
  spread(id: ID!): Spread
}

# Mutations
type Mutation {
  # Auth
  register(input: RegisterInput!): AuthPayload!
  login(input: LoginInput!): AuthPayload!
  logout: Boolean!
  
  # User
  updateProfile(input: UpdateProfileInput!): User!
  
  # Readings
  createReading(input: CreateReadingInput!): Reading!
  likeReading(readingId: ID!): Reading!
  
  # Subscription
  subscribe(plan: SubscriptionTier!): Subscription!
  purchaseCoins(amount: Int!): User!
}

# Subscriptions
type Subscription {
  readingUpdated(readingId: ID!): Reading!
  dailyNotification: Notification!
}
```

### 4.2 REST API Endpoints

#### ì¸ì¦ ê´€ë ¨
```yaml
POST /api/auth/register
  Body: { email, password, birthDate }
  Response: { token, user }

POST /api/auth/login
  Body: { email, password }
  Response: { token, user }

POST /api/auth/refresh
  Body: { refreshToken }
  Response: { token, refreshToken }

POST /api/auth/logout
  Headers: { Authorization: Bearer <token> }
  Response: { success }
```

#### íƒ€ë¡œ ë¦¬ë”©
```yaml
POST /api/readings
  Headers: { Authorization }
  Body: { spreadType, question, category }
  Response: { reading }

GET /api/readings/:id
  Headers: { Authorization }
  Response: { reading }

GET /api/readings/daily
  Headers: { Authorization }
  Response: { card, message }

GET /api/readings/history
  Headers: { Authorization }
  Query: { page, limit, category }
  Response: { readings, total, hasMore }
```

#### ê²°ì œ ê´€ë ¨
```yaml
POST /api/payments/subscribe
  Headers: { Authorization }
  Body: { plan, paymentMethod }
  Response: { subscription, invoice }

POST /api/payments/coins
  Headers: { Authorization }
  Body: { amount, paymentMethod }
  Response: { coins, transaction }

GET /api/payments/history
  Headers: { Authorization }
  Query: { page, limit }
  Response: { transactions, total }
```

### 4.3 WebSocket Events

```javascript
// Client -> Server
{
  "event": "join_reading",
  "data": { "readingId": "uuid" }
}

{
  "event": "request_live_interpretation",
  "data": { "readingId": "uuid", "question": "string" }
}

// Server -> Client
{
  "event": "interpretation_update",
  "data": { "partial": "string", "complete": false }
}

{
  "event": "daily_notification",
  "data": { "message": "string", "cardOfDay": {} }
}

{
  "event": "reading_shared",
  "data": { "userId": "uuid", "readingId": "uuid" }
}
```

---

## 5. AI/ML ì‹œìŠ¤í…œ

### 5.1 AI ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

```python
# AI Service Structure
class TarotAIService:
    def __init__(self):
        self.gpt_client = OpenAIClient()
        self.sentiment_analyzer = SentimentAnalyzer()
        self.personalization_engine = PersonalizationEngine()
        self.pattern_recognizer = PatternRecognizer()
    
    async def generate_interpretation(
        self,
        cards: List[Card],
        spread: Spread,
        question: str,
        user_context: UserContext
    ) -> Interpretation:
        # 1. ì¹´ë“œ ì¡°í•© ë¶„ì„
        card_patterns = self.pattern_recognizer.analyze(cards)
        
        # 2. ì‚¬ìš©ì ë§ì¶¤ ì»¨í…ìŠ¤íŠ¸ ìƒì„±
        context = self.personalization_engine.create_context(
            user_context,
            question,
            card_patterns
        )
        
        # 3. GPT-4 í•´ì„ ìƒì„±
        interpretation = await self.gpt_client.generate(
            prompt=self._build_prompt(cards, spread, context),
            temperature=0.7,
            max_tokens=1000
        )
        
        # 4. ê°ì • ë¶„ì„
        sentiment = self.sentiment_analyzer.analyze(interpretation)
        
        return Interpretation(
            text=interpretation,
            sentiment=sentiment,
            keywords=card_patterns.keywords,
            advice=self._extract_advice(interpretation)
        )
```

### 5.2 í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§

```python
SYSTEM_PROMPT = """
You are an experienced tarot reader with deep knowledge of symbolism, 
psychology, and spiritual guidance. Your interpretations should be:
1. Insightful and meaningful
2. Personalized to the querent's situation
3. Balanced between spiritual and practical advice
4. Hopeful but realistic
5. Around 200-300 words

User Context:
- Age: {age}
- Interest: {interests}
- Previous themes: {themes}
- Current question: {question}
"""

CARD_INTERPRETATION_PROMPT = """
Cards drawn:
{cards_description}

Spread: {spread_name}
Positions: {positions}

Please provide an interpretation that:
1. Connects all cards into a cohesive narrative
2. Addresses the querent's question directly
3. Offers practical advice and action steps
4. Highlights the main message and theme
"""
```

### 5.3 ê°œì¸í™” ì•Œê³ ë¦¬ì¦˜

```python
class PersonalizationEngine:
    def __init__(self):
        self.user_embeddings = {}
        self.reading_history = {}
        
    def create_user_embedding(self, user_id: str) -> np.ndarray:
        """ì‚¬ìš©ì ë²¡í„° ìƒì„±"""
        history = self.get_user_history(user_id)
        
        features = {
            'reading_frequency': self.calculate_frequency(history),
            'preferred_categories': self.get_category_distribution(history),
            'sentiment_trend': self.analyze_sentiment_trend(history),
            'interaction_patterns': self.get_interaction_patterns(history),
            'demographic_features': self.get_demographics(user_id)
        }
        
        return self.vectorize_features(features)
    
    def recommend_spread(self, user_id: str, context: dict) -> str:
        """ì‚¬ìš©ìì—ê²Œ ìµœì ì˜ ìŠ¤í”„ë ˆë“œ ì¶”ì²œ"""
        user_embedding = self.create_user_embedding(user_id)
        spread_embeddings = self.get_spread_embeddings()
        
        scores = cosine_similarity(user_embedding, spread_embeddings)
        return self.spreads[np.argmax(scores)]
    
    def personalize_interpretation(
        self,
        base_interpretation: str,
        user_profile: UserProfile
    ) -> str:
        """í•´ì„ ê°œì¸í™”"""
        # ì‚¬ìš©ì ì„ í˜¸ í†¤ ì ìš©
        tone_adjusted = self.adjust_tone(
            base_interpretation,
            user_profile.preferred_tone
        )
        
        # ê´€ì‹¬ì‚¬ í‚¤ì›Œë“œ ê°•ì¡°
        interest_highlighted = self.highlight_interests(
            tone_adjusted,
            user_profile.interests
        )
        
        # ì´ì „ í”¼ë“œë°± ë°˜ì˜
        feedback_applied = self.apply_feedback(
            interest_highlighted,
            user_profile.feedback_history
        )
        
        return feedback_applied
```

### 5.4 íŒ¨í„´ ì¸ì‹ ì‹œìŠ¤í…œ

```python
class PatternRecognizer:
    def __init__(self):
        self.patterns = self.load_patterns()
        
    def analyze(self, cards: List[Card]) -> PatternAnalysis:
        patterns_found = []
        
        # 1. ì•„ë¥´ì¹´ë‚˜ ë¶„í¬ ë¶„ì„
        arcana_pattern = self.check_arcana_distribution(cards)
        if arcana_pattern:
            patterns_found.append(arcana_pattern)
        
        # 2. ìˆ«ì íŒ¨í„´ ë¶„ì„
        number_pattern = self.check_number_patterns(cards)
        if number_pattern:
            patterns_found.append(number_pattern)
        
        # 3. ì›ì†Œ ê· í˜• ë¶„ì„
        element_balance = self.analyze_elements(cards)
        patterns_found.append(element_balance)
        
        # 4. ì¹´ë“œ ì¡°í•© ì‹œë„ˆì§€
        synergies = self.find_card_synergies(cards)
        patterns_found.extend(synergies)
        
        return PatternAnalysis(
            patterns=patterns_found,
            strength=self.calculate_pattern_strength(patterns_found),
            keywords=self.extract_keywords(patterns_found)
        )
```

---

## 6. UI/UX ìƒì„¸ ì„¤ê³„

### 6.1 ë””ìì¸ ì‹œìŠ¤í…œ

#### ìƒ‰ìƒ íŒ”ë ˆíŠ¸
```css
:root {
  /* Primary Colors */
  --primary-purple: #6B46C1;
  --primary-gold: #F59E0B;
  --primary-midnight: #1E293B;
  
  /* Secondary Colors */
  --mystic-blue: #3B82F6;
  --cosmic-pink: #EC4899;
  --sage-green: #10B981;
  
  /* Neutral Colors */
  --gray-900: #111827;
  --gray-700: #374151;
  --gray-500: #6B7280;
  --gray-300: #D1D5DB;
  --gray-100: #F3F4F6;
  
  /* Gradient */
  --mystic-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --gold-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}
```

#### íƒ€ì´í¬ê·¸ë˜í”¼
```css
/* Font System */
--font-display: 'Playfair Display', serif;  /* ì œëª© */
--font-body: 'Inter', sans-serif;           /* ë³¸ë¬¸ */
--font-mystic: 'Cinzel', serif;             /* ì‹ ë¹„ë¡œìš´ í…ìŠ¤íŠ¸ */

/* Font Sizes */
--text-xs: 0.75rem;    /* 12px */
--text-sm: 0.875rem;   /* 14px */
--text-base: 1rem;     /* 16px */
--text-lg: 1.125rem;   /* 18px */
--text-xl: 1.25rem;    /* 20px */
--text-2xl: 1.5rem;    /* 24px */
--text-3xl: 1.875rem;  /* 30px */
--text-4xl: 2.25rem;   /* 36px */
```

### 6.2 í•µì‹¬ í™”ë©´ ì„¤ê³„

#### í™ˆ í™”ë©´
```javascript
const HomeScreen = {
  components: [
    {
      type: 'Header',
      content: {
        greeting: 'ì•ˆë…•í•˜ì„¸ìš”, {username}ë‹˜',
        subtitle: 'ì˜¤ëŠ˜ì˜ ìš´ì„¸ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”'
      }
    },
    {
      type: 'DailyCard',
      animation: 'fadeInScale',
      interaction: 'tap-to-reveal'
    },
    {
      type: 'QuickActions',
      items: [
        { icon: 'cards', label: 'íƒ€ë¡œ ë¦¬ë”©', action: 'navigate:reading' },
        { icon: 'history', label: 'ì§€ë‚œ ë¦¬ë”©', action: 'navigate:history' },
        { icon: 'learn', label: 'ì¹´ë“œ ë°°ìš°ê¸°', action: 'navigate:learn' }
      ]
    },
    {
      type: 'RecentReadings',
      limit: 3,
      layout: 'horizontal-scroll'
    }
  ]
};
```

#### ì¹´ë“œ ë½‘ê¸° í™”ë©´
```javascript
const CardDrawScreen = {
  steps: [
    {
      id: 'question',
      component: 'QuestionInput',
      validation: 'required|min:10',
      placeholder: 'ë§ˆìŒì† ì§ˆë¬¸ì„ ë– ì˜¬ë ¤ë³´ì„¸ìš”...'
    },
    {
      id: 'shuffle',
      component: 'CardShuffle',
      animation: 'physics-based',
      duration: 3000,
      hapticFeedback: true
    },
    {
      id: 'select',
      component: 'CardSelection',
      layout: 'spread',
      selectable: true,
      maxSelection: 'spread-dependent'
    },
    {
      id: 'reveal',
      component: 'CardReveal',
      animation: 'flip-3d',
      stagger: 500
    },
    {
      id: 'interpretation',
      component: 'InterpretationDisplay',
      features: ['text-to-speech', 'save', 'share']
    }
  ]
};
```

### 6.3 ì• ë‹ˆë©”ì´ì…˜ ì‹œìŠ¤í…œ

```javascript
// ì¹´ë“œ ì• ë‹ˆë©”ì´ì…˜ ì •ì˜
const cardAnimations = {
  shuffle: {
    type: 'spring',
    stiffness: 100,
    damping: 15,
    mass: 1
  },
  flip: {
    duration: 600,
    easing: 'cubic-bezier(0.455, 0.03, 0.515, 0.955)',
    transformStyle: 'preserve-3d'
  },
  float: {
    duration: 3000,
    loop: true,
    easing: 'ease-in-out',
    keyframes: [
      { transform: 'translateY(0px)' },
      { transform: 'translateY(-10px)' },
      { transform: 'translateY(0px)' }
    ]
  },
  glow: {
    duration: 2000,
    loop: true,
    keyframes: [
      { boxShadow: '0 0 5px rgba(107, 70, 193, 0.5)' },
      { boxShadow: '0 0 20px rgba(107, 70, 193, 0.8)' },
      { boxShadow: '0 0 5px rgba(107, 70, 193, 0.5)' }
    ]
  }
};
```

### 6.4 ë°˜ì‘í˜• ë””ìì¸

```css
/* Breakpoints */
--mobile: 320px;
--tablet: 768px;
--desktop: 1024px;
--wide: 1440px;

/* Layout Grid */
.container {
  width: 100%;
  margin: 0 auto;
  padding: 0 16px;
}

@media (min-width: 768px) {
  .container {
    max-width: 750px;
    padding: 0 24px;
  }
}

@media (min-width: 1024px) {
  .container {
    max-width: 1000px;
    padding: 0 32px;
  }
}

/* Card Grid Responsive */
.card-grid {
  display: grid;
  gap: 16px;
  grid-template-columns: 1fr;
}

@media (min-width: 768px) {
  .card-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 1024px) {
  .card-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}
```

---

## 7. ë³´ì•ˆ ë° ì¸í”„ë¼

### 7.1 ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ì¸ì¦ ë° ì¸ê°€
- [x] JWT í† í° êµ¬í˜„ (Access + Refresh)
- [x] í† í° ë§Œë£Œ ì‹œê°„ ì„¤ì • (Access: 1h, Refresh: 7d)
- [x] Rate Limiting (IPë‹¹ ë¶„ë‹¹ 60 ìš”ì²­)
- [x] CORS ì •ì±… ì„¤ì •
- [x] OAuth 2.0 ì†Œì…œ ë¡œê·¸ì¸ (Google, Apple, Kakao)

#### ë°ì´í„° ë³´í˜¸
- [x] ë¹„ë°€ë²ˆí˜¸ í•´ì‹± (bcrypt, salt rounds: 12)
- [x] ë¯¼ê° ì •ë³´ ì•”í˜¸í™” (AES-256)
- [x] SQL Injection ë°©ì§€ (Parameterized Queries)
- [x] XSS ë°©ì§€ (Input Sanitization)
- [x] HTTPS ì ìš© (SSL/TLS)

#### ê²°ì œ ë³´ì•ˆ
- [x] PCI DSS ì¤€ìˆ˜
- [x] ì¹´ë“œ ì •ë³´ ë¯¸ì €ì¥ (í† í°í™”)
- [x] ê²°ì œ ê²€ì¦ ì´ì¤‘í™”
- [x] í™˜ë¶ˆ ì •ì±… ë° í”„ë¡œì„¸ìŠ¤

### 7.2 AWS ì¸í”„ë¼ êµ¬ì„±

```yaml
# Infrastructure as Code (Terraform)
resource "aws_vpc" "main" {
  cidr_block = "10.0.0.0/16"
  
  tags = {
    Name = "tarotmind-vpc"
  }
}

resource "aws_eks_cluster" "main" {
  name     = "tarotmind-cluster"
  role_arn = aws_iam_role.eks.arn
  
  vpc_config {
    subnet_ids = aws_subnet.private[*].id
  }
}

resource "aws_rds_cluster" "postgres" {
  cluster_identifier      = "tarotmind-db"
  engine                  = "aurora-postgresql"
  engine_version          = "15.2"
  database_name           = "tarotmind"
  master_username         = "admin"
  master_password         = var.db_password
  backup_retention_period = 7
  preferred_backup_window = "03:00-04:00"
}

resource "aws_elasticache_cluster" "redis" {
  cluster_id           = "tarotmind-cache"
  engine               = "redis"
  node_type            = "cache.t3.micro"
  num_cache_nodes      = 1
  parameter_group_name = "default.redis7"
}

resource "aws_s3_bucket" "assets" {
  bucket = "tarotmind-assets"
  
  cors_rule {
    allowed_headers = ["*"]
    allowed_methods = ["GET", "HEAD"]
    allowed_origins = ["*"]
    max_age_seconds = 3000
  }
}
```

### 7.3 ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

```yaml
# DataDog Configuration
monitors:
  - name: "API Response Time"
    type: metric
    query: "avg(last_5m):avg:trace.express.request{service:tarotmind-api} > 1000"
    message: "API response time is above 1 second"
    
  - name: "Error Rate"
    type: metric
    query: "avg(last_5m):sum:trace.express.request.errors{service:tarotmind-api} > 100"
    message: "High error rate detected"
    
  - name: "Database Connection Pool"
    type: metric
    query: "avg(last_5m):avg:postgresql.connections{db:tarotmind} > 90"
    message: "Database connection pool usage is high"

# Logging Strategy
logging:
  levels:
    production: INFO
    staging: DEBUG
    development: DEBUG
    
  outputs:
    - type: CloudWatch
      logGroup: /aws/eks/tarotmind
      
    - type: ElasticSearch
      index: tarotmind-logs
      
  structured_logging:
    format: JSON
    fields:
      - timestamp
      - level
      - message
      - service
      - traceId
      - userId
      - error
```

---

## 8. ê°œë°œ í”„ë¡œì„¸ìŠ¤

### 8.1 Sprint ê³„íš (2ì£¼ ë‹¨ìœ„)

#### Sprint 1-2: ê¸°ì´ˆ ì„¤ì •
- í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •
- ê°œë°œ í™˜ê²½ êµ¬ì¶•
- CI/CD íŒŒì´í”„ë¼ì¸ ì„¤ì •
- ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ë° êµ¬ì¶•

#### Sprint 3-4: í•µì‹¬ ë°±ì—”ë“œ
- ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ
- íƒ€ë¡œ ì¹´ë“œ ë°ì´í„° ëª¨ë¸
- ê¸°ë³¸ API êµ¬í˜„
- íƒ€ë¡œ ì—”ì§„ í”„ë¡œí† íƒ€ì…

#### Sprint 5-6: í”„ë¡ íŠ¸ì—”ë“œ ê¸°ì´ˆ
- ì•± ê¸°ë³¸ êµ¬ì¡°
- UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- í™ˆ í™”ë©´ ë° ë„¤ë¹„ê²Œì´ì…˜
- ì¹´ë“œ ë·°ì–´ êµ¬í˜„

#### Sprint 7-8: ë¦¬ë”© ì‹œìŠ¤í…œ
- ìŠ¤í”„ë ˆë“œ ì‹œìŠ¤í…œ êµ¬í˜„
- ì¹´ë“œ ì…”í”Œ ë° ì„ íƒ ë¡œì§
- AI í•´ì„ í†µí•©
- ë¦¬ë”© íˆìŠ¤í† ë¦¬

#### Sprint 9-10: ê°œì¸í™” ë° ê²°ì œ
- ê°œì¸í™” ì—”ì§„ êµ¬í˜„
- êµ¬ë… ì‹œìŠ¤í…œ
- ê²°ì œ í†µí•©
- í‘¸ì‹œ ì•Œë¦¼

#### Sprint 11-12: ìµœì í™” ë° ì¶œì‹œ
- ì„±ëŠ¥ ìµœì í™”
- ë³´ì•ˆ ì ê²€
- ë² íƒ€ í…ŒìŠ¤íŠ¸
- ì¶œì‹œ ì¤€ë¹„

### 8.2 ê°œë°œ ì›Œí¬í”Œë¡œìš°

```yaml
Git Flow:
  main: í”„ë¡œë•ì…˜ ë°°í¬ ë¸Œëœì¹˜
  develop: ê°œë°œ í†µí•© ë¸Œëœì¹˜
  feature/*: ê¸°ëŠ¥ ê°œë°œ ë¸Œëœì¹˜
  hotfix/*: ê¸´ê¸‰ ìˆ˜ì • ë¸Œëœì¹˜
  release/*: ë¦´ë¦¬ì¦ˆ ì¤€ë¹„ ë¸Œëœì¹˜

Commit Convention:
  feat: ìƒˆë¡œìš´ ê¸°ëŠ¥
  fix: ë²„ê·¸ ìˆ˜ì •
  docs: ë¬¸ì„œ ìˆ˜ì •
  style: ì½”ë“œ í¬ë§·íŒ…
  refactor: ì½”ë“œ ë¦¬íŒ©í† ë§
  test: í…ŒìŠ¤íŠ¸ ì¶”ê°€
  chore: ë¹Œë“œ ì—…ë¬´ ìˆ˜ì •

PR Process:
  1. Feature ë¸Œëœì¹˜ ìƒì„±
  2. ê°œë°œ ë° í…ŒìŠ¤íŠ¸
  3. PR ìƒì„±
  4. Code Review (ìµœì†Œ 1ëª…)
  5. CI í†µê³¼ í™•ì¸
  6. Merge to develop
```

### 8.3 ì½”ë“œ í’ˆì§ˆ ê´€ë¦¬

```javascript
// ESLint Configuration
module.exports = {
  extends: [
    'eslint:recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:react/recommended',
    'prettier'
  ],
  rules: {
    'no-console': 'warn',
    'no-unused-vars': 'error',
    'prefer-const': 'error',
    '@typescript-eslint/explicit-module-boundary-types': 'error'
  }
};

// Jest Configuration
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  coverageThreshold: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80
    }
  }
};
```

---

## 9. í…ŒìŠ¤íŠ¸ ì „ëµ

### 9.1 í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ

```
         E2E Tests (10%)
        /            \
       /              \
    Integration Tests (30%)
    /                    \
   /                      \
  Unit Tests (60%)
```

### 9.2 í…ŒìŠ¤íŠ¸ êµ¬í˜„

#### Unit Tests
```typescript
// Card Service Test
describe('TarotCardService', () => {
  let service: TarotCardService;
  
  beforeEach(() => {
    service = new TarotCardService();
  });
  
  describe('shuffleCards', () => {
    it('should return 78 cards', () => {
      const shuffled = service.shuffleCards();
      expect(shuffled).toHaveLength(78);
    });
    
    it('should return cards in different order', () => {
      const first = service.shuffleCards();
      const second = service.shuffleCards();
      expect(first).not.toEqual(second);
    });
  });
  
  describe('drawCards', () => {
    it('should draw specified number of cards', () => {
      const cards = service.drawCards(3);
      expect(cards).toHaveLength(3);
    });
    
    it('should not draw duplicate cards', () => {
      const cards = service.drawCards(10);
      const uniqueCards = new Set(cards.map(c => c.id));
      expect(uniqueCards.size).toBe(10);
    });
  });
});
```

#### Integration Tests
```typescript
// API Integration Test
describe('POST /api/readings', () => {
  it('should create a new reading', async () => {
    const response = await request(app)
      .post('/api/readings')
      .set('Authorization', `Bearer ${token}`)
      .send({
        spreadType: 'three-card',
        question: 'What should I focus on today?',
        category: 'general'
      });
    
    expect(response.status).toBe(201);
    expect(response.body).toHaveProperty('reading');
    expect(response.body.reading).toHaveProperty('id');
    expect(response.body.reading.cards).toHaveLength(3);
  });
  
  it('should enforce daily limit for free users', async () => {
    // Create first reading
    await createReading(freeUserToken);
    
    // Try second reading
    const response = await createReading(freeUserToken);
    
    expect(response.status).toBe(429);
    expect(response.body.error).toBe('Daily reading limit reached');
  });
});
```

#### E2E Tests
```typescript
// Cypress E2E Test
describe('Complete Reading Flow', () => {
  beforeEach(() => {
    cy.login('test@example.com', 'password123');
  });
  
  it('should complete a three-card reading', () => {
    // Navigate to reading
    cy.visit('/');
    cy.get('[data-testid="start-reading"]').click();
    
    // Select spread
    cy.get('[data-testid="spread-three-card"]').click();
    
    // Enter question
    cy.get('[data-testid="question-input"]')
      .type('What should I focus on in my career?');
    cy.get('[data-testid="continue-button"]').click();
    
    // Shuffle cards
    cy.get('[data-testid="shuffle-button"]').click();
    cy.wait(3000); // Wait for animation
    
    // Select cards
    cy.get('[data-testid^="card-"]').first().click();
    cy.get('[data-testid^="card-"]').eq(10).click();
    cy.get('[data-testid^="card-"]').last().click();
    
    // View interpretation
    cy.get('[data-testid="reveal-button"]').click();
    cy.get('[data-testid="interpretation"]').should('be.visible');
    cy.get('[data-testid="save-reading"]').click();
    
    // Verify saved
    cy.visit('/history');
    cy.get('[data-testid="reading-list"]')
      .children()
      .should('have.length.at.least', 1);
  });
});
```

### 9.3 ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

```javascript
// K6 Load Testing Script
import http from 'k6/http';
import { check, sleep } from 'k6';

export const options = {
  stages: [
    { duration: '2m', target: 100 }, // Ramp up
    { duration: '5m', target: 100 }, // Stay at 100 users
    { duration: '2m', target: 200 }, // Ramp up to 200
    { duration: '5m', target: 200 }, // Stay at 200
    { duration: '2m', target: 0 },   // Ramp down
  ],
  thresholds: {
    http_req_duration: ['p(95)<500'], // 95% of requests under 500ms
    http_req_failed: ['rate<0.1'],    // Error rate under 10%
  },
};

export default function () {
  // Login
  const loginRes = http.post(`${__ENV.API_URL}/auth/login`, {
    email: 'test@example.com',
    password: 'password123',
  });
  
  check(loginRes, {
    'login successful': (r) => r.status === 200,
  });
  
  const token = loginRes.json('token');
  
  // Create reading
  const readingRes = http.post(
    `${__ENV.API_URL}/readings`,
    {
      spreadType: 'daily',
      category: 'general',
    },
    {
      headers: { Authorization: `Bearer ${token}` },
    }
  );
  
  check(readingRes, {
    'reading created': (r) => r.status === 201,
    'has interpretation': (r) => r.json('reading.interpretation') !== null,
  });
  
  sleep(1);
}
```

---

## 10. ë°°í¬ ë° ìš´ì˜

### 10.1 CI/CD Pipeline

```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run tests
        run: npm test -- --coverage
        
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        
  build:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Build Docker image
        run: |
          docker build -t tarotmind-api:${{ github.sha }} .
          docker tag tarotmind-api:${{ github.sha }} ${{ secrets.ECR_REGISTRY }}/tarotmind-api:latest
          
      - name: Push to ECR
        run: |
          aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin ${{ secrets.ECR_REGISTRY }}
          docker push ${{ secrets.ECR_REGISTRY }}/tarotmind-api:latest
          
  deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to EKS
        run: |
          aws eks update-kubeconfig --name tarotmind-cluster --region ap-northeast-2
          kubectl set image deployment/api api=${{ secrets.ECR_REGISTRY }}/tarotmind-api:latest
          kubectl rollout status deployment/api
```

### 10.2 ëª¨ë°”ì¼ ì•± ë°°í¬

#### iOS ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] App Store Connect ê³„ì • ì„¤ì •
- [ ] ì•± ID ë° ë²ˆë“¤ ID ë“±ë¡
- [ ] í”„ë¡œë¹„ì €ë‹ í”„ë¡œíŒŒì¼ ìƒì„±
- [ ] ì•± ì•„ì´ì½˜ (1024x1024) ì¤€ë¹„
- [ ] ìŠ¤í¬ë¦°ìƒ· ì¤€ë¹„ (ê° ë””ë°”ì´ìŠ¤ í¬ê¸°ë³„)
- [ ] ì•± ì„¤ëª… ë° í‚¤ì›Œë“œ ìµœì í™”
- [ ] ì—°ë ¹ ë“±ê¸‰ ì„¤ì •
- [ ] TestFlight ë² íƒ€ í…ŒìŠ¤íŠ¸
- [ ] ì‹¬ì‚¬ ì œì¶œ

#### Android ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] Google Play Console ê³„ì • ì„¤ì •
- [ ] ì•± ì„œëª… í‚¤ ìƒì„± ë° ê´€ë¦¬
- [ ] ì•± ë²ˆë“¤ (.aab) ë¹Œë“œ
- [ ] ìŠ¤í† ì–´ ë“±ë¡ì •ë³´ ì‘ì„±
- [ ] ì½˜í…ì¸  ë“±ê¸‰ ì„¤ì •
- [ ] íƒ€ê²Ÿ êµ­ê°€ ë° ì–¸ì–´ ì„¤ì •
- [ ] ê°€ê²© ë° ë°°í¬ ì„¤ì •
- [ ] ë‚´ë¶€/ë² íƒ€ í…ŒìŠ¤íŠ¸
- [ ] í”„ë¡œë•ì…˜ ì¶œì‹œ

### 10.3 ìš´ì˜ ë§¤ë‰´ì–¼

#### ì¼ì¼ ì²´í¬ë¦¬ìŠ¤íŠ¸
```bash
# ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
kubectl get pods -n production
kubectl top nodes
kubectl top pods -n production

# ë¡œê·¸ í™•ì¸
kubectl logs -f deployment/api -n production
aws cloudwatch tail /aws/eks/tarotmind --follow

# ë©”íŠ¸ë¦­ í™•ì¸
- API ì‘ë‹µ ì‹œê°„
- ì—ëŸ¬ìœ¨
- í™œì„± ì‚¬ìš©ì ìˆ˜
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ìˆ˜
```

#### ì¥ì•  ëŒ€ì‘ í”„ë¡œì„¸ìŠ¤
```yaml
Severity Levels:
  P1: ì „ì²´ ì„œë¹„ìŠ¤ ë‹¤ìš´
    - Response Time: 15ë¶„ ì´ë‚´
    - Resolution Time: 1ì‹œê°„ ì´ë‚´
    
  P2: ì£¼ìš” ê¸°ëŠ¥ ì¥ì• 
    - Response Time: 30ë¶„ ì´ë‚´
    - Resolution Time: 4ì‹œê°„ ì´ë‚´
    
  P3: ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì• 
    - Response Time: 2ì‹œê°„ ì´ë‚´
    - Resolution Time: 24ì‹œê°„ ì´ë‚´
    
  P4: ë§ˆì´ë„ˆ ì´ìŠˆ
    - Response Time: 24ì‹œê°„ ì´ë‚´
    - Resolution Time: 72ì‹œê°„ ì´ë‚´

Escalation Path:
  1. On-call Engineer
  2. Team Lead
  3. CTO
  4. CEO
```

#### ë°±ì—… ë° ë³µêµ¬
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
pg_dump -h $DB_HOST -U $DB_USER -d tarotmind > backup_$(date +%Y%m%d).sql

# S3 ë°±ì—…
aws s3 sync s3://tarotmind-assets s3://tarotmind-backup-assets

# ë³µêµ¬ ì ˆì°¨
psql -h $DB_HOST -U $DB_USER -d tarotmind < backup_20250114.sql
```

---

## ğŸ“Š ì„±ê³µ ì§€í‘œ ëª¨ë‹ˆí„°ë§

### ê¸°ìˆ ì  KPI
| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|----------|
| API ì‘ë‹µì‹œê°„ (p95) | < 500ms | DataDog APM |
| ì—ëŸ¬ìœ¨ | < 0.1% | Sentry |
| ê°€ë™ì‹œê°„ | > 99.9% | StatusPage |
| ì•± í¬ë˜ì‹œìœ¨ | < 1% | Firebase Crashlytics |
| ì•± ë¡œë”© ì‹œê°„ | < 3ì´ˆ | Firebase Performance |

### ë¹„ì¦ˆë‹ˆìŠ¤ KPI
| ì§€í‘œ | ëª©í‘œ (3ê°œì›”) | ì¸¡ì • ë°©ë²• |
|------|-------------|----------|
| DAU | 10,000 | Google Analytics |
| MAU | 50,000 | Google Analytics |
| ìœ ì§€ìœ¨ (D30) | > 40% | Amplitude |
| ìœ ë£Œ ì „í™˜ìœ¨ | > 3% | Internal Analytics |
| ARPU | â‚©5,000 | Revenue / MAU |
| ì•±ìŠ¤í† ì–´ í‰ì  | > 4.5 | App Store, Play Store |

---

## ğŸ”š ê²°ë¡ 

ë³¸ ê°œë°œ ê¸°íšì„œëŠ” TarotMind ì•±ì˜ ê¸°ìˆ ì  êµ¬í˜„ì„ ìœ„í•œ ìƒì„¸ ê°€ì´ë“œì…ë‹ˆë‹¤. 

### í•µì‹¬ ì„±ê³µ ìš”ì†Œ
1. **ì•ˆì •ì ì¸ ì•„í‚¤í…ì²˜**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê¸°ë°˜ í™•ì¥ ê°€ëŠ¥í•œ ì„¤ê³„
2. **AI í†µí•©**: GPT-4 ê¸°ë°˜ ê°œì¸í™”ëœ í•´ì„ ì œê³µ
3. **ìš°ìˆ˜í•œ UX**: ì§ê´€ì ì´ê³  ë§¤ë ¥ì ì¸ ì‚¬ìš©ì ê²½í—˜
4. **ë°ì´í„° ê¸°ë°˜ ìš´ì˜**: ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ê³¼ ê°œì„ 

### ë‹¤ìŒ ë‹¨ê³„
1. ê°œë°œíŒ€ êµ¬ì„± ì™„ë£Œ
2. ìƒì„¸ íƒœìŠ¤í¬ ë¶„ë°°
3. Sprint 1 í‚¥ì˜¤í”„
4. ì£¼ê°„ ì§„í–‰ìƒí™© ë¦¬ë·°

---

**ë¬¸ì„œ ë²„ì „**: v1.0  
**ì‘ì„±ì¼**: 2025ë…„ 1ì›” 14ì¼  
**ì‘ì„±ì**: TarotMind Development Team  
**ê²€í† ì**: CTO, Tech Lead, Product Manager
